{#
Params:

enumerate
day_courses: dict[course] -> key为小节号 1-14 14为网课
course.name
course.location

current_day: time -> 当前所在日期的时间

#}


{% extends "layouts/defaultLayout.html" %}
{% block navbar_content %}
<li><a href={{ url_for('schedule.toweek_course_', ) }}>本周课程</a></li>
<!--<li style="width: 50%">-->
<!--&lt;!&ndash;<a id="datepicker" onclick="pickadate()">&ndash;&gt;-->
<!--&lt;!&ndash;{{ time.month }}/{{ time.day }}/{{ time.year }}&ndash;&gt;-->
<!--&lt;!&ndash;</a>&ndash;&gt;-->
<!--<input id="datepicker" class="datepicker" type="date">-->
<!--</li>-->
{% endblock %}


{% block navbar_tabs %}
<li class="tab"><a href="#course_offline">常规课程</a></li>
<li class="tab"><a href="#course_online">线上课程</a></li>
{% endblock %}


{% block content %}
<div  id="pick" class="container">
  <div id="course_offline" class="col s12">
    <div class="row">
      <div class="col input-field">
        <blockquote id="day_text">
        <input id="datepicker" class="datepicker" type="date">
        </blockquote>
      </div>
    </div>
    <ul class="collapsible popout" data-collapsible="accordion" id="collapsible_offline">
      {% for _i, sec in enumerate([Section(1),Section(4),Section(6),Section(8),Section(11)]) %}
      {% if day_courses[sec.name] %}
      <li>
        <div class="collapsible-header">
          <i class="material-icons">event</i>
          第{{ (['一','二','三','四','五'])[_i] }}大节
        </div>
        <div class="collapsible-body">
          {% for course in day_courses[sec.name] %}
          {{ course.name }}
          <br>
          {{ course.location }}
          {% endfor %}
        </div>
      </li>
      {% else %}
      <li>
        <div class="collapsible-header">
          <i class="material-icons">event</i>
          第{{ (['一','二','三','四','五'])[_i] }}大节
        </div>
        <div class="collapsible-body">
          无
        </div>
      </li>
      {% endif %}
      {% endfor %}
    </ul>
  </div>
  <div id="course_online" class="col s12">
    <blockquote>
      线上课程
    </blockquote>
    <div class="container">
      <ul class="collapsible popout" data-collapsible="accordion" id="collapsible_online">
        <li>
          <div class="collapsible-header">
            <i class="material-icons">event</i>
            线上课程
          </div>
          <div class="collapsible-body">
            {% for course in day_courses['online'] %}
            {{ course.name }}
            <br>
            {{ course.location }}
            {% endfor %}
          </div>
        </li>
      </ul>
    </div>
  </div>
</div>
{% endblock %}


{% block script_content %}
<!--Color format-->
<style>
  .picker__date-display {
    background-color: #ffab40;
  }

  .picker__day--selected, .picker__day--selected:hover, .picker--focused .picker__day--selected {
    background-color: #ffab40;
  }

  .picker__close, .picker__today, .picker__clear {
    color: #f57c00;
  }

  .picker__day.picker__day--today {
    color: #f57c00;
  }

  #datepicker {
    background-color: rgba(0, 0, 0, 0);
    border: none;
    /* border-bottom: 1px solid rgb(158, 158, 158); */
    border-radius: 0;
    outline: none;
    height: 3rem;
    width: 50%;
    font-size: 1rem;
    margin: 0 0 0 0;
    padding: 0;
    -webkit-box-shadow: none;
    box-shadow: none;
    -webkit-box-sizing: content-box;
    box-sizing: content-box;
    -webkit-transition: all 0.3s;
    transition: all 0.3s;
  }

  }

</style>
<script type="text/javascript">
  $(document).ready(function () {
    $('.collapsible').collapsible();
    $("#collapsible_online").collapsible('open', 0);
    var s1 = (new Date()).setHours(10, 25);
    var s2 = (new Date()).setHours(12, 15);
    var s3 = (new Date()).setHours(15, 35);
    var s4 = (new Date()).setHours(17, 15);
    var nowTime = Date.now();
    if (nowTime <= s1)
      $("#collapsible_offline").collapsible('open', 0);
    else if (nowTime < s2)
      $("#collapsible_offline").collapsible('open', 1);
    else if (nowTime < s3)
      $("#collapsible_offline").collapsible('open', 2);
    else if (nowTime < s4)
      $("#collapsible_offline").collapsible('open', 3);
    else
      $("#collapsible_offline").collapsible('open', 4);
    $('.datepicker').pickadate({
      selectMonths: true, // Creates a dropdown to control month
      selectYears: 5, // Creates a dropdown of 15 years to control year
      format: "mm/dd/yyyy",
    });
    $('#datepicker').val("{{ time.month }}/{{ time.day }}/{{ time.year }}");
    $('.picker').bind('DOMNodeInserteds', function(){
      month = {
        Jan: 1,
        Feb: 2,
        Mar: 3,
        Apr: 4,
        May: 5,
        Jun: 6,
        Jul: 7,
        Aug: 8,
        Sep: 9,
        Oct: 10,
        Nov: 11,
        Dec: 12,
      };
      var year = $('.picker__year-display').text();
      var month_ = $('.picker__month-display').text().trim();
      var day = $('.picker__day-display').text();
      location.href = '/schedule/today_course%3Fyear%3D' + year + '%3Fmonth%3D' + month[month_] + '%3Fday%3D' + day
    })
  });
</script>
{% endblock %}
