"use strict";var style="<style>label.error{color: red; font-size: 15px; position: relative; padding-bottom: 5px;}</style>",applyInGroup="<form id='applyInGroup'> <div class='row'>   <div class='input-field col s12'>     <input id='applyInGroupContent' type='text' class='validate' name='apply_in_text'>\n     <label for='applyInGroupContent'>请求内容</label>   </div> </div> <div class='row'>   <a class=\"btn waves-effect waves-light right\" onclick='subGroupHandler()'>发送\n    <i class=\"material-icons right\">send</i>\n   </a> </div> </form>",field={username:{required:!0,minlength:1,maxlength:30},password:{required:!0,minlength:5,maxlength:30},confimPassword:{required:!0,minlength:5,maxlength:30,equalTo:"#password"},date:{required:!0,dateISO:!0},title:{required:!0,minlength:5,maxlength:50},text:{required:!0,maxlength:500},email:{maxlength:30,required:!1,email:!0},phoneNumber:{required:!0,digits:!0,minlength:11,maxlength:11},number:{required:!0,digits:!0},require:{required:!0},secondary:{require:!1}},Form={confirmForm:{content:{number:field.number,name:field.text},url:"/profile/bind_info"},signinForm:{content:{account:field.username,permission:field.require,password:field.password,confimPassword:field.confimPassword},url:"/authentication/signin"},loginForm:{content:{account:field.username,password:field.password},url:"/authentication/login"},phoneForm:{content:{smsCode:field.number,newPassword:field.password},url:"/profile/validate_phone"},profileForm:{content:{nickname:field.username,sex:field.require,email:field.email,birthday:field.date,password:field.password,confimPassword:field.confimPassword},url:"/profile/change_info"},infoForm:{content:{info:field.text},url:"/profile/"},codeSubmitForm:{content:{sign_code:field.number},url:"/attendance/register"},attendanceForm:{content:{sign_code:field.number},url:"/attendance/validate"},reAttendanceForm:{content:{account:field.username},url:"/attendance/resign"},groupForm:{content:{groupName:field.username,groupClass:field.require,groupInfo:field.secondary},url:"/group/register"},mutateGroupForm:{content:{groupName:field.username,groupClass:field.require,groupInfo:field.text},url:"/group/mutate_group"},subscribeGroupForm:{content:{groupNumber:field.require},url:"/group/search"},sendAnnoForm:{content:{annoTitle:field.title,annoContent:field.text},url:"/group/send"},sendMsgForm:{content:{msgTitle:field.title,mdgContent:field.text},url:"/group/send"},manageMsgForm:{content:{manageMsgID:field.number,manageMsgTitle:field.title,manageMsgContent:field.text},url:"/group/update_msg"},activityForm:{content:{activityName:field.title,activityContent:field.text,activityStartDate:field.require,activityStartTime:field.require,activityEndDate:field.require,activityEndTime:field.require},url:"/group/register_activity"},activityChangeForm:{content:{activityChangeName:field.title,activityChangeContent:field.text,activityChangeStartDate:field.require,activityChangeStartTime:field.require,activityChangeEndDate:field.require,activityChangeEndTime:field.require},url:"/group/mutate_activity"},issueForm:{content:{issueType:field.require,issueContent:field.text},url:"/issue"}},defaultErrorPlacement=function(e,r){r.next().next().attr("id")===r.id+"-wrapper"?e.appendTo(r.parent().next()):(r.next().after('<div id="'+r.id+'-wrapper" class="row" style="margin-bottom: 4px"></div>'),e.appendTo(r.next().next()))},defaultAction=function(e){return function(r){302===r.status?location.href=r.location:e(r)}};$.fn.serializeJSON=function(){var e={},r=this.serializeArray();return $.each(r,function(){void 0!==e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),JSON.stringify(e)},$.afterPOST=function(e){return function(r){return function(t){$.post(r,$(t).serializeArray(),defaultAction(e))}}},$(document).ready(function(){$("#signinForm").validate({rules:Form.signinForm.content,errorPlacement:defaultErrorPlacement,submitHandler:$.afterPOST(signinFormHandler)(Form.signinForm.url)}),$("#loginForm").validate({rules:Form.loginForm.content,errorPlacement:defaultErrorPlacement,submitHandler:$.afterPOST(loginFormHandler)(Form.loginForm.url)}),$("#phoneForm").validate({rules:Form.phoneForm.content,errorPlacement:defaultErrorPlacement,submitHandler:$.afterPOST(phoneFormHandler)(Form.phoneForm.url)}),$("#confirmForm").validate({rules:Form.confirmForm.content,errorPlacement:defaultErrorPlacement,submitHandler:$.afterPOST(confirmFormHandler)(Form.confirmForm.url)}),$("#profileForm").validate({rules:Form.profileForm.content,errorPlacement:defaultErrorPlacement,submitHandler:$.afterPOST(profileFormHandler)(Form.profileForm.url)}),$("#attendanceForm").validate({rules:Form.attendanceForm.content,errorPlacement:defaultErrorPlacement,submitHandler:function(e){$.post("/attendance/validate%3Fsign_name%3D"+currentSignName,$(e).serializeArray(),defaultAction(attendanceFormHandler))}}),$("#reAttendanceForm").validate({rules:Form.reAttendanceForm.content,errorPlacement:defaultErrorPlacement,submitHandler:$.afterPOST(reAttendanceFormHandler)(Form.attendanceForm.url)}),$("#infoForm").validate({rules:Form.infoForm.content,errorPlacement:defaultErrorPlacement,submitHandler:$.afterPOST(infoFormHandler)(Form.infoForm.url)}),$("#codeSubmitForm").validate({rules:Form.codeSubmitForm.content,errorPlacement:defaultErrorPlacement,submitHandler:function(e){$.post("/attendance/register%3Fclass%3D"+currentAttdCls+"%3Fid%3D"+currentAttdID+"%3Fqrcode%3D0",$(e).serializeArray(),defaultAction(codeSubmitFormHandler))}}),$("#manageMsgForm").validate({rules:Form.manageMsgForm.content,errorPlacement:defaultErrorPlacement,submitHandler:function(e){var r=getId(),t=$("#manageMsgID").val(),n="";$("#public-body").hasClass("active")?n="board":$("#chat-body").hasClass("active")&&(n="public"),$.post(Form.manageMsgForm.url+"%3Fgroup%3D"+r+"%3Fchannel%3D"+n+"%3Findex%3D"+t,$(e).serializeArray(),defaultAction(manageMsgFormHandler))}}),$("#groupForm").validate({rules:Form.groupForm.content,errorPlacement:defaultErrorPlacement,submitHandler:$.afterPOST(groupFormHandler)(Form.groupForm.url)}),$("#mutateGroupForm").validate({rules:Form.mutateGroupForm.content,errorPlacement:defaultErrorPlacement,submitHandler:function(e){var r=getId();$.post(Form.mutateGroupForm.url+"%3Fgroup%3d"+r,$(e).serializeArray(),defaultAction(changeGroupFormHandler))}}),$("#subscribeGroup").validate({rules:Form.subscribeGroupForm.content,errorPlacement:defaultErrorPlacement,submitHandler:function(e){$.post(Form.subscribeGroupForm.url,$(e).serializeArray(),function(e){var r=$("#exist");r&&r.remove();var t=$('<ul id="exist" class="collection"></ul>');e.found?e.groups.map(function(e){return $('<li class="collection-item" style="opacity: 0;"><div>'+e.name+'<a href="#" onclick="insertAIGForm('+e.id+')" class="secondary-content">申请入群<i class="material-icons right">send</i></a></div></li>')}).forEach(function(e){return t.append(e)}):t.append($('<li class="collection-item red-text"><i class="material-icons left">close</i>没有找到</li>'));$("#insert").after(t),Materialize.showStaggeredList("#exist")})}}),$("#sendAnno").validate({rules:Form.sendAnnoForm.content,errorPlacement:defaultErrorPlacement,submitHandler:function(e){var r=getId();$.post(Form.sendAnnoForm.url+"%3Fgroup%3D"+r+"%3Fchannel%3Dboard",$(e).serializeArray(),defaultAction(sendAnnoFormHandler))}}),$("#sendMsg").validate({rules:Form.sendMsgForm.content,errorPlacement:defaultErrorPlacement,submitHandler:function(e){var r=getId();$.post(Form.sendMsgForm.url+"%3Fgroup%3D"+r+"%3Fchannel%3Dpublic",$(e).serializeArray(),defaultAction(sendAnnoFormHandler))}}),$("#activityForm").validate({rules:Form.activityForm.content,errorPlacement:defaultErrorPlacement,submitHandler:function(e){var r=getId();$.post(Form.activityForm.url+"%3Fgroup%3D"+r,$(e).serializeArray(),defaultAction(activityFormHandler))}}),$("#activityChangeForm").validate({rules:Form.activityChangeForm.content,errorPlacement:defaultErrorPlacement,submitHandler:function(e){var r=getId();$.post(Form.activityChangeForm.url+"%3Fgroup%3D"+r+"%3Factivity%3D"+$("#activityID").val(),$(e).serializeArray(),defaultAction(activityFormHandler))}}),$("#issueForm").validate({rules:Form.issueForm.content,errorPlacement:defaultErrorPlacement,submitHandler:$.afterPOST(issueFormHandler)(Form.issueForm.url)}),$("title").append(style)});